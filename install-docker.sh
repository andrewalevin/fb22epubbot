#!/bin/bash

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Docker
if ! command -v docker &> /dev/null; then
    echo "üõë Docker –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–æ–ø—ã—Ç–∫—É."
    exit 1
fi

# –ó–∞–ø—Ä–æ—Å BOT_TOKEN
read -p "üîë –í–≤–µ–¥–∏—Ç–µ BOT_TOKEN: " BOT_TOKEN

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–π —Ç–æ–∫–µ–Ω
if [ -z "$BOT_TOKEN" ]; then
    echo "‚ö†Ô∏è BOT_TOKEN –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω."
    exit 1
fi

# –ò–º—è Docker –æ–±—Ä–∞–∑–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –Ω—É–∂–Ω–æ–µ)
IMAGE_NAME="andrewlevin/ytb2audiobot"

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º
docker run -d --env BOT_TOKEN="$BOT_TOKEN" "$IMAGE_NAME"

if [ $? -eq 0 ]; then
    echo "üöÄ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω."
else
    echo "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞."
    exit 1
fi